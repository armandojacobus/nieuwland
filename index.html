<!DOCTYPE html>
<html lang="nl">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Demo integratie WGP 5 viewer</title>
  <link rel="stylesheet" type="text/css" href="./example.css">
  <!-- Noot: include WGP 5 css ná evt. eigen css. -->
  <link rel="stylesheet" type="text/css" href="./lib/css/viewer.css">
  <link rel="icon" type="image/x-icon" href="./favicon.ico">
</head>

<body>
  <div class="page-wrapper">
    <h2>Voorbeeld integratie WGP 5 viewer</h2>
    <div class="example-wrapper">
      <div class="example-container">
        <div>
          <h4>Log box: <button id="btn-clear-log-box">Wis log</button></h4>
          <div id="log-box"></div>
        </div>
      </div>
      <div id="map-container"></div>
    </div>
  </div>
  <script type="text/javascript" src="./lib/js/wgp-viewer.js"></script>
  <script type="text/javascript">
    var workspaceName = 'jam-it';
    var mapName = 'vorbeeldkaart-met-authenticatie';

    // Noot: een geldig JWT token zetten is nodig als:
    // * De kaart niet publiek toegankelijk is en een inlog vereist.
    // * Of de kaart lagen bevat die via de WGP 5 proxy lopen.
    var jwtToken = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOjE1NjkyNTA3NDEsImV4cCI6MTU2OTI1Nzk0MSwicm9sZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJ1c2VybmFtZSI6ImFqYWNvYnVzIn0.SArZh0wVxYA8qyTmGB4avA71zpgZl7Xk4VKqYVdwUZeAyDNFcq27S2L9qdKoVgKSyBvbgkEDUUK62m2iHIR1uAXPTgLRlfsBKUVqFYA1tmdzUuvg5knXHLPXw3te0S0UHjH7tNNI90nyCkzalDE0ON63xo0vqb-2pm0dv6tK01jfh4AjQ6WMybc7FjJP444d-JZ1ZMRlIDcJCcu9H3ljAbQtOEPQCIMbDf3V8C2oMfMzB7qE5pnHK7Qs5P6fpwT5paUSDdbNfB5cZT465yvhtIRPkdzx53YjsNrNQgKtDNPSFsmwM5v9cKWHw9EdDkahgPJ4XrSxpbVYWNLADdLda2-F8iRdyQywsqLu8WtC-y_TzPXYohto4uw8Snxjbh3sa4zvbHCK8QUJBz74ULwXFPG1lULEUx3a5_KaMWpIbr98OfPC4O4r1qYaIKgsrpqK_iwAVS8JG6ggYgv-YLad-O0hJapJi_kDjxLNwjRPZUUgL6rJLJmUAnBMbgqh0lYOenUEIR8bqmS4m__-U99JB74lSNt9Z4ASUx2TeY4u0WeJhNuiDeKAvmTMiExqWWR42YWZNTkRW6v25MaCkD6Q8x1J89k12H_1mxBjD1gS1R6WZt0ic3jFMaM2_uSvjl62mLY1uBpLywLld0qqJcfwaR0m_utYckmVi8AlMMygvN8';
    wgp.setJwtToken(jwtToken);

    // Initialiseer pad naar library scripts.
    // Deze is nodig opdat wgp de vertaalbestanden en image assets kan vinden.
    wgp.setAssetBaseUrl('./lib/');

    // Haal kaartconfiguratie op via WGP API.
    // Noot: kaartconfiguratie ophalen hoeft niet per se in de viewer te gebeuren.
    //       Het enige dat van belang is, is dat wgp.initViewer met een geldig
    //       configuratie-object wordt aangeroepen.
    wgp.setWgpServerUrl('https://jam-it.webgis.nl');
    log('Kaart' + mapName);
    log('Kaartconfiguratie wordt opgehaald...');
    wgp.fetchMapConfig(workspaceName, mapName).then(function (mapConfig) {
      var containerElement = document.getElementById('map-container');
      wgp.initViewer(mapConfig, containerElement).then(function (api) {
        // Voeg api-instance toe aan global scope om er mee te kunnen spelen in de dev console.
        window.api = api;
        log('Viewer geïnitialiseerd. Api is klaar voor gebruik.');

        // Voorbeeld api-gebruik: zoom naar coördinaat en zoomlevel.
        api.map.setCenter([102030, 431122], { zoom: 14 });
      });
    }).catch(function (err) {
      log('Fout bij ophalen kaartconfig: ' + err, 'error');
    });

    function log(message, messageClass) {
      var messageNode = document.createElement('div');
      messageNode.innerHTML = message;
      messageNode.classList.add('message');
      if (messageClass) {
        messageNode.classList.add(messageClass);
      }

      var logbox = document.getElementById('log-box');
      logbox.appendChild(messageNode);

      var scrollHeight = logbox.scrollHeight;
      logbox.scrollTop = scrollHeight;
    }
  </script>
</body>

</html>
